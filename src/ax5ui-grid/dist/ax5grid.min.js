"use strict";!function(t,a){var i,e=ax5.util,n=function(){var n;a&&a.call(this),this.name="ax5grid",this.version="0.0.2",this.config={clickEventName:"click",theme:"default",animateTime:250,frozenColumnIndex:0,frozenRowIndex:0,rightSum:!1,footSum:!1,showLineNumber:!1,showRowSelector:!1,height:400,columnMinWidth:100,asideColumnWidth:30,header:{columnHeight:23},body:{columnHeight:23}},this.colGroup=[],this.data=[],n=this.config;var o=function(t){var a={rows:[]},i=0,e=function o(t,e,r){for(var d={cols:[]},l=0,s=t.length;s>l;l++){var h=t[l],c=1;h.hidden||(h.colspan=1,h.rowspan=1,h.rowIndex=e,h.colIndex=function(){return r?(i=r.colIndex+l+1,r.colIndex+l):i++}(),d.cols.push(h),"columns"in h?c=o(h.columns,e+1,h):h.width="width"in h?h.width:n.columnMinWidth,h.colspan=c)}return d.cols.length>0?(a.rows[e]||(a.rows[e]={cols:[]}),a.rows[e].cols=a.rows[e].cols.concat(d.cols),d.cols.length-1+c):c};return e(t,0),function(){for(var t=0,i=a.rows.length;i>t;t++)for(var e=a.rows[t],n=0,o=e.cols.length;o>n;n++){var r=e.cols[n];"columns"in r||(r.rowspan=i-t)}}(),a},r=function(){var t={instanceId:this.id};return this.$target.html(i.tmpl.get("main",t)),this.$={container:{root:this.$target.find('[data-ax5grid-container="root"]'),header:this.$target.find('[data-ax5grid-container="header"]'),body:this.$target.find('[data-ax5grid-container="body"]')},panel:{"aside-header":this.$target.find('[data-ax5grid-panel="aside-header"]'),"left-header":this.$target.find('[data-ax5grid-panel="left-header"]'),header:this.$target.find('[data-ax5grid-panel="header"]'),"right-header":this.$target.find('[data-ax5grid-panel="right-header"]'),"top-aside-body":this.$target.find('[data-ax5grid-panel="top-aside-body"]'),"top-left-body":this.$target.find('[data-ax5grid-panel="top-left-body"]'),"top-body":this.$target.find('[data-ax5grid-panel="top-body"]'),"top-right-body":this.$target.find('[data-ax5grid-panel="rop-right-body"]'),"aside-body":this.$target.find('[data-ax5grid-panel="aside-body"]'),"left-body":this.$target.find('[data-ax5grid-panel="left-body"]'),body:this.$target.find('[data-ax5grid-panel="body"]'),"right-body":this.$target.find('[data-ax5grid-panel="right-body"]'),"bottom-aside-body":this.$target.find('[data-ax5grid-panel="bottom-aside-body"]'),"bottom-left-body":this.$target.find('[data-ax5grid-panel="bottom-left-body"]'),"bottom-body":this.$target.find('[data-ax5grid-panel="bottom-body"]'),"bottom-right-body":this.$target.find('[data-ax5grid-panel="bottom-right-body"]')}},this.$.container.root.css({height:n.height}),this},d=function(t){this.columns=e.deepCopy(t),this.headerTable=o.call(this,this.columns);for(var a={},i=0,n=this.headerTable.rows.length;n>i;i++)for(var r=this.headerTable.rows[i],d=0,l=r.cols.length;l>d;d++)a[r.cols[d].colIndex]=jQuery.extend({},r.cols[d]);this.colGroup=[];for(var s in a)this.colGroup.push(a[s]);return this},l=function(t){var a=(this.$.container.root.width(),this.$.container.root.height()),i=function(){var t=0;return n.showLineNumber&&(t+=n.asideColumnWidth),n.showRowSelector&&(t+=n.asideColumnWidth),t}(),e=this.headerTable.rows.length*n.header.columnHeight,o=function(t,a,e,n){var o={},r=!1;switch(e){case"aside":0===i?(t.hide(),r=!0):o.width=i;break;case"left":break;case"right":}return r?this:(t.css(o),this)};this.$.container.header.css({height:e}),this.$.container.body.css({height:a-e}),o.call(this,this.$.panel["aside-header"],"","aside","header"),o.call(this,this.$.panel["left-header"],"","left","header"),o.call(this,this.$.panel.header,"","","header"),o.call(this,this.$.panel["right-header"],"","right","header")};this.init=function(t){this.onStateChanged=n.onStateChanged,this.onClick=n.onClick;var a=this.gridConfig=jQuery.extend(!0,{},n,t);return a.target?(this.$target=jQuery(a.target),this.id||(this.id=this.$target.data("data-ax5grid-id")),this.id||(this.id="ax5grid-"+ax5.getGuid(),this.$target.data("data-ax5grid-id",a.id)),function(t){e.isObject(t)&&!t.error&&(a=jQuery.extend(!0,a,t))}(e.parseJson(this.$target.attr("data-ax5grid-config"),!0)),r.call(this),d.call(this,a.columns),i.header.init.call(this),i.header.repaint.call(this),i.body.init.call(this),i.body.repaint.call(this),l.call(this,!0),this):(console.log(ax5.info.getError("ax5grid","401","init")),this)},this.align=function(){return l.call(this),this},this.setData=function(t){return i.data.set.call(this,t),i.body.repaint.call(this),this},this.main=function(){t.grid_instance=t.grid_instance||[],t.grid_instance.push(this),arguments&&e.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};i=t.grid=function(){return e.isFunction(a)&&(n.prototype=new a),n}()}(ax5.ui,ax5.ui.root),function(t){var a=function(){this.bodyRowTable={},this.leftBodyRowData={},this.bodyRowData={},this.rightBodyRowData={},this.bodyRowTable=i.call(this,this.columns)},i=function(t){var a={rows:[]},i=0,e=function n(t,e,o){for(var r={cols:[]},d=0,l=t.length,s=(function g(t){for(var a=0,d=t.length;d>a;a++){var l=t[a],s=1;l.hidden||("key"in l?(l.colspan=1,l.rowspan=1,l.rowIndex=e,l.colIndex=function(){return o?(i=o.colIndex+a+1,o.colIndex+a):i++}(),r.cols.push(l),"columns"in l&&(s=n(l.columns,e+1,l)),l.colspan=s):"columns"in l&&g(l.columns,e))}});l>d;d++){var h=t[d],c=1;h.hidden||("key"in h?(h.colspan=1,h.rowspan=1,h.rowIndex=e,h.colIndex=function(){return o?(i=o.colIndex+d+1,o.colIndex+d):i++}(),r.cols.push(h),"columns"in h&&(c=n(h.columns,e+1,h)),h.colspan=c):"columns"in h&&s(h.columns,e))}return r.cols.length>0?(a.rows[e]||(a.rows[e]={cols:[]}),a.rows[e].cols=a.rows[e].cols.concat(r.cols),r.cols.length-1+c):c};return e(t,0),function(){for(var t=0,i=a.rows.length;i>t;t++)for(var e=a.rows[t],n=0,o=e.cols.length;o>n;n++){var r=e.cols[n];"columns"in r||(r.rowspan=i-t)}}(),a},e=function(){var a=this.config,i=t.util.divideTableByFrozenColumnIndex(this.bodyRowTable,this.config.frozenColumnIndex),e=this.leftBodyRowData=i.leftData,n=this.bodyRowData=i.rightData,o=this.data,r=function(t,i,e,n){var o=[];o.push('<table border="0" cellpadding="0" cellspacing="0">'),o.push("<colgroup>");for(var r=0,d=i.length;d>r;r++)o.push('<col style="width:'+i[r]._realWidth+';"  />');o.push("</colgroup>");for(var l=0,s=n.length;s>l;l++)for(var h=0,c=e.rows.length;c>h;h++){o.push('<tr style="height: '+a.body.columnHeight+'px;">');for(var g=0,u=e.rows[h].cols.length;u>g;g++){var p=e.rows[h].cols[g],f=a.body.columnHeight*p.rowspan;o.push('<td colspan="'+p.colspan+'" rowspan="'+p.rowspan+'" style="line-height: '+a.body.columnHeight+'px;min-height: 1px;">'),o.push('<div data-ax5grid-cellBG="" style="height:'+f+'px;"></div>'),o.push('<span data-ax5grid-cellHolder="" style="">',n[l][p.key]||"&nbsp;","</span>"),o.push("</td>")}o.push("</tr>")}o.push("</table>"),t.html(o.join(""))};a.frozenColumnIndex>0&&r(this.$.panel["left-body"],this.leftHeaderColGroup,e,o),r(this.$.panel.body,this.headerColGroup,n,o),a.rightSum},n=function(){var a=t.util.divideTableByFrozenColumnIndex(this.bodyRowTable,this.config.frozenColumnIndex),i=this.leftBodyRowData=a.leftData,e=this.bodyRowData=a.rightData,n=this.data,o=function(){for(var t=this.cols.length;t--;)this.cols[t]["@dataIndex"]=this["@dataIndex"];return this.cols},r=function(){return{value:n[this["@dataIndex"]][this.key]||"&nbsp;"}};this.config.frozenColumnIndex>0&&this.$.panel["left-body"].html(t.tmpl.get("body",{list:n,"@rows":function(){for(var t=i.rows.length;t--;)i.rows[t]["@dataIndex"]=this["@i"];return i.rows},"@cols":o,"@columnValue":r})),this.$.panel.body.html(t.tmpl.get("body",{list:n,"@rows":function(){for(var t=e.rows.length;t--;)e.rows[t]["@dataIndex"]=this["@i"];return e.rows},"@cols":o,"@columnValue":r}))},o=function(){};t.body={init:a,repaint:e,repaintByTmpl:n,setData:o}}(ax5.ui.grid),function(t){var a=ax5.util,i=function(){},e=function(t){return this.data=a.deepCopy(t),this},n=function(){};t.data={init:i,set:e,get:n}}(ax5.ui.grid),function(t){var a=function(){this.leftHeaderData={},this.headerData={},this.rightHeaderData={}},i=function(){var a=t.util.divideTableByFrozenColumnIndex(this.headerTable,this.config.frozenColumnIndex);this.leftHeaderData=a.leftData,this.headerData=a.rightData,this.leftHeaderColGroup=this.colGroup.slice(0,this.config.frozenColumnIndex),this.headerColGroup=this.colGroup.slice(this.config.frozenColumnIndex);var i=this.config,e=function(){return ax5.util.isNumber(this.width)?(this._realWidth=this.width+"px",this._realWidth):(this._realWidth=void 0,"")},n=function(){return i.header.columnHeight+"px"},o=function(){return"height:"+i.header.columnHeight*this.rowspan+"px"};this.config.frozenColumnIndex>0&&this.$.panel["left-header"].html(t.tmpl.get("header",{"@getColWidth":e,"@getRowHeight":n,"@getColStyle":o,colGroup:this.leftHeaderColGroup,table:this.leftHeaderData})),this.$.panel.header.html(t.tmpl.get("header",{"@getColWidth":e,"@getRowHeight":n,"@getColStyle":o,colGroup:this.headerColGroup,table:this.headerData})),this.config.rightSum&&this.$.panel["right-header"].html(t.tmpl.get("header",{"@getColWidth":e,"@getRowHeight":n,"@getColStyle":o,table:this.rightHeaderData}))};t.header={init:a,repaint:i}}(ax5.ui.grid),function(t){var a=function(){};t.scroller={init:a}}(ax5.ui.grid),function(t){var a='<div data-ax5grid-container="root" data-ax5grid-instance="{{instanceId}}">\n            <div data-ax5grid-container="header">\n                <div data-ax5grid-panel="aside-header"></div>\n                <div data-ax5grid-panel="left-header"></div>\n                <div data-ax5grid-panel="header"></div>\n                <div data-ax5grid-panel="right-header"></div>\n            </div>\n            <div data-ax5grid-container="body">\n                <div data-ax5grid-panel="top-aside-body"></div>\n                <div data-ax5grid-panel="top-left-body"></div>\n                <div data-ax5grid-panel="top-body"></div>\n                <div data-ax5grid-panel="top-right-body"></div>\n                <div data-ax5grid-panel="aside-body"></div>\n                <div data-ax5grid-panel="left-body"></div>\n                <div data-ax5grid-panel="body"></div>\n                <div data-ax5grid-panel="right-body"></div>\n                <div data-ax5grid-panel="bottom-aside-body"></div>\n                <div data-ax5grid-panel="bottom-left-body"></div>\n                <div data-ax5grid-panel="bottom-body"></div>\n                <div data-ax5grid-panel="bottom-right-body"></div>\n            </div>\n        </div>',i='<table border="0" cellpadding="0" cellspacing="0">\n            <colgroup>\n            {{#colGroup}}<col style="width:{{@getColWidth}};" />{{/colGroup}}\n            </colgroup>\n            {{#table.rows}} \n            <tr style="height:{{@getRowHeight}};">\n                {{#cols}}\n                <td colspan="{{colspan}}" rowspan="{{rowspan}}">\n                    <div data-ax5grid-cellBG="" style="{{@getColStyle}}"></div>\n                    <span data-ax5grid-cellHolder="">{{{label}}}</span>\n                </td>\n                {{/cols}}\n            </tr>\n            {{/table.rows}}\n        </table>\n        ';t.tmpl={main:a,header:i,get:function(a,i){return ax5.mustache.render(t.tmpl[a],i)}}}(ax5.ui.grid),function(t){var a=function(t,a){for(var i={rows:[]},e={rows:[]},n=0,o=t.rows.length;o>n;n++){var r=t.rows[n];i.rows[n]={cols:[]},e.rows[n]={cols:[]};for(var d=0,l=r.cols.length;l>d;d++){var s=jQuery.extend({},r.cols[d]),h=s.colIndex,c=s.colIndex+s.colspan;if(a>h)if(a>=c)i.rows[n].cols.push(s);else{var g=jQuery.extend({},s),u=jQuery.extend({},g);g.colspan=a-g.colIndex,u.colIndex=a,u.colspan=s.colspan-g.colspan,i.rows[n].cols.push(g),e.rows[n].cols.push(u)}else e.rows[n].cols.push(s)}}return{leftData:i,rightData:e}};t.util={divideTableByFrozenColumnIndex:a}}(ax5.ui.grid);